#! /bin/sh

. $BUILD_BASE/bin/repoutils

updaterepo() {
  if [ -d $BUILD_BASE/source/$1 ]; then
    echo Updating ${1}...
    info=`tree_info $1` || exit 1
    repo=`repo_url $info`
    hg -R $BUILD_BASE/source/$1 pull $repo
  fi
}

if [ "$1" ]; then
  if [ "$1" = "all" ]; then
    for tree in `trees`
    do
      updaterepo $tree
    done
  else
    updaterepo $1
  fi
else
  info=`tree_info` || exit 1
  tree=`tree $info`
  updaterepo $tree
fi
